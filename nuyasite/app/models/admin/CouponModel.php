<?php    use Model\IN_Model;    class CouponModel extends IN_Model    {        public function createCoupon()        {            if($_POST){                $ep = filter_var($_POST['ep'],FILTER_SANITIZE_STRING);                $key = $this->generate_key();                $createTime = date("Y-m-d H:i:s");                $id = rand(10000000,999999999);                $this->db->insert('kuponlar',array('id'=>$id,'anahtar'=>$key,'ep'=>$ep,'status'=>'0','create_date'=>$createTime));                Functions::setAdminLog("$id ID'li Kupon OluÅŸturdu");            }        }        public function generate_key()        {            static $max = 60466175;            return strtoupper(sprintf(                "%05s-%05s-%05s-%05s",                base_convert(mt_rand(0, $max), 10, 36),                base_convert(mt_rand(0, $max), 10, 36),                base_convert(mt_rand(0, $max), 10, 36),                base_convert(mt_rand(0, $max), 10, 36)            ));        }        public function usedcoupon()        {            return $this->db->select()->table('kuponlar')->where(array('status'=>'1'))->get();        }        public function unusedcoupon()        {            return $this->db->select()->table('kuponlar')->where(array('status'=>'0'))->get();        }        public function delete($arg,$arg2)        {            $control = $this->db->select('id')->table('kuponlar')->where(array('id'=>$arg))->count();            if($control <= 0){                URI::redirect('error');                exit();            }else{                $this->db->delete('kuponlar',array('id'=>$arg));                Functions::setAdminLog("$arg ID'li Kuponu Sildi");                Session::init();                Session::set('changeOK',true);                if($arg2 == 1){                    URI::redirect('coupon/used');                }elseif($arg2 == 2){                    URI::redirect('coupon/unused');                }            }        }    }