<?php    use Model\IN_Model;    class CroneModel extends IN_Model    {        public function start()        {            $getEvent = $this->db->select('id,startDate')->table('event_crone')->where(array('status'=>'0'))->get();            if (count($getEvent) != 0){                foreach ($getEvent as $row){                    $time = strtotime($row['startDate']);                    $now = time();                    if ($now > $time){                        $id = $row['id'];                        $getEvent2 = $this->db->select('eventFlag,eventNotice')->table('event_crone')->where(array('id'=>$id))->get()[0];                        $eventFlag = $getEvent2['eventFlag'];                        $fullEventNotice = $this->noticeExplode($getEvent2['eventNotice']);                        $startNotice = $this->noticeExplode2($fullEventNotice[0]);                        $startNoticeCount = count($startNotice);                        Functions::sendServer("$eventFlag 1","EVENT");                        for ($i = 0; $i <= $startNoticeCount-1; $i++){                            Functions::sendServer($startNotice[$i]);                        }                        $this->db->update('event_crone',array('status'=>'1'),array('id'=>$id));                    }                }            }        }        public function end()        {            $getEvent = $this->db->select('id,finishDate')->table('event_crone')->where(array('status'=>'1'))->get();            if (count($getEvent) != 0){                foreach ($getEvent as $row){                    date_default_timezone_set('Asia/Bahrain');                    $time = strtotime($row['finishDate']);                    $now = time();                    if ($now > $time){                        $id = $row['id'];                        $getEvent2 = $this->db->select('eventFlag,eventNotice')->table('event_crone')->where(array('id'=>$id))->get()[0];                        $eventFlag = $getEvent2['eventFlag'];                        $fullEventNotice = $this->noticeExplode($getEvent2['eventNotice']);                        $endNotice = $this->noticeExplode2($fullEventNotice[1]);                        $endNoticeCount = count($endNotice);                        Functions::sendServer("$eventFlag 0","EVENT");                        for ($i = 0; $i <= $endNoticeCount-1; $i++){                            Functions::sendServer($endNotice[$i]);                        }                        $this->db->delete('event_crone',array('id'=>$id));                    }                }            }        }        public function noticeExplode($value)        {            $data = explode('[END_ENTER]',$value);            return $data;        }        public function noticeExplode2($value)        {            $data = explode('[ENTER]',$value);            return $data;        }    }